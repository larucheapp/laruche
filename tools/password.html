<!DOCTYPE html>
<html lang="fr" data-app="laruche" >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Générateur de Mots de Passe</title>
  <meta name="description" content="Générez des mots de passe complexes et sécurisés en un clic.">
  <style>
    :root{
      --color-bg:#FFFFFF;
      --color-bg-alt:#F7F8FA;
      --color-border:#E9EAF0;
      --color-text-primary:#141417;
      --color-text-secondary:#6B7280;
      --color-violet:#7C3AED;
      --color-violet-dark:#6D28D9;
      --radius-md:12px;
      --radius-lg:14px;
      --tool-max-w:480px; /* par défaut, peut être changé via body[data-size] */
    }

    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{height:100%;background-color:var(--color-bg)}
    body{
      height:100vh; overflow:hidden; display:flex; flex-direction:column;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Inter",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
      color:var(--color-text-primary); line-height:1.5; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body[data-size="default"]{--tool-max-w:480px}
    body[data-size="wide"]{--tool-max-w:960px}
    body[data-size="xl"]{--tool-max-w:1200px}

    #bg-canvas{position:fixed;inset:0;width:100%;height:100%;z-index:-1}

    .app-header{
      flex-shrink:0; background:var(--color-bg-alt); border-bottom:1px solid var(--color-border);
      padding:0 24px; display:flex; align-items:center; height:70px;
    }
    .app-header a{display:inline-flex; align-items:center}
    .logo-img{height:70px; width:auto; vertical-align:middle}

    .main-content{
      flex-grow:1; display:flex; align-items:center; justify-content:center;
      padding:48px 24px; overflow-y:auto;
    }
    .tool-wrapper{display:flex; flex-direction:column; align-items:center; position:relative}
    .tool-title{
      font-size:1.75rem; font-weight:600; padding:12px 28px;
      background:linear-gradient(45deg,var(--color-violet),var(--color-violet-dark));
      color:#fff; border-radius:var(--radius-md); margin-bottom:-20px; position:relative; z-index:5;
      box-shadow:0 4px 14px -4px rgba(124,58,237,.4);
    }
    .generator-card{
      background:var(--color-bg); border:1px solid var(--color-border); border-radius:var(--radius-lg);
      padding:28px; padding-top:40px; width:100%; max-width:var(--tool-max-w);
      box-shadow:0 4px 6px -1px rgb(0 0 0 / 5%), 0 2px 4px -2px rgb(0 0 0 / 5%);
      display:flex; flex-direction:column; gap:24px;
    }
    .form-group{display:flex; flex-direction:column; gap:8px}
    .form-label{font-weight:500; color:var(--color-text-primary)}
    .form-input{
      width:100%; padding:10px 14px; border:1px solid var(--color-border); border-radius:var(--radius-md);
      font-size:1rem; color:var(--color-text-primary); background:var(--color-bg);
      transition:border-color .2s, box-shadow .2s;
    }
    .form-input:focus{outline:none; border-color:var(--color-violet); box-shadow:0 0 0 3px rgba(124,58,237,.2)}
    .actions{display:flex; justify-content:flex-end; gap:12px}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      font-weight:500; padding:10px 16px; border-radius:var(--radius-md); border:none; cursor:pointer;
      transition:background-color .2s, box-shadow .2s; font-size:14px;
    }
    .btn:focus-visible{outline:2px solid transparent; outline-offset:2px; box-shadow:0 0 0 3px rgba(124,58,237,.4)}
    .btn-primary{background:var(--color-violet); color:#fff}
    .btn-primary:hover:not(:disabled){background:var(--color-violet-dark)}
    .btn-primary:disabled{background:#A78BFA; cursor:not-allowed}
    .status-text{font-size:14px; color:var(--color-text-secondary); text-align:center; min-height:21px}

    /* Styles spécifiques à l'outil */
    .output-wrapper { display: flex; gap: 12px; align-items: center; }
    .output-wrapper .form-input {
      flex-grow: 1;
      font-family: 'SF Mono', 'Fira Code', 'Fira Mono', 'Roboto Mono', monospace;
      font-size: 1.1rem;
      text-align: center;
      letter-spacing: 1px;
      background-color: var(--color-bg-alt);
    }
    .output-wrapper .btn { flex-shrink: 0; padding: 10px; }
    .length-control { display: flex; align-items: center; gap: 16px; }
    .length-value { font-weight: 600; font-size: 1rem; color: var(--color-violet); background-color: var(--color-bg-alt); padding: 4px 8px; border-radius: 8px; min-width: 4ch; text-align: center; }
    .full-width-btn { width: 100%; font-size: 1rem; padding: 12px; }

    /* --- Styles améliorés pour les contrôles --- */

    /* Curseur de longueur personnalisé */
    .length-control input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      flex-grow: 1;
      height: 8px;
      background: var(--color-bg-alt);
      border-radius: 4px;
      outline: none;
    }
    .length-control input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: var(--color-violet);
      border-radius: 50%;
      border: 2px solid var(--color-bg);
      box-shadow: 0 1px 4px rgba(0,0,0,0.2);
      cursor: grab;
      margin-top: -6px;
      transition: transform .2s ease;
    }
    .length-control input[type="range"]:active::-webkit-slider-thumb {
      transform: scale(1.1);
      cursor: grabbing;
    }
    .length-control input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: var(--color-violet);
      border-radius: 50%;
      border: 2px solid var(--color-bg);
      box-shadow: 0 1px 4px rgba(0,0,0,0.2);
      cursor: grab;
    }

    /* Options de caractères personnalisées */
    .options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .option-item {
      position: relative;
      display: block;
      padding: 12px 16px 12px 48px;
      border-radius: var(--radius-md);
      border: 1px solid var(--color-border);
      background-color: var(--color-bg);
      cursor: pointer;
      transition: border-color .2s, background-color .2s;
      user-select: none;
      font-size: 14px;
      font-weight: 500;
    }
    .option-item:hover {
      border-color: #d1d5db;
      background-color: var(--color-bg-alt);
    }
    .option-item input[type="checkbox"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }
    .option-item .checkmark {
      position: absolute;
      top: 50%;
      left: 16px;
      transform: translateY(-50%);
      height: 22px;
      width: 22px;
      background-color: var(--color-bg-alt);
      border: 1px solid var(--color-border);
      border-radius: 6px;
      transition: all .2s;
    }
    .option-item:hover .checkmark {
      border-color: #c5c8d1;
    }
    .option-item input[type="checkbox"]:checked ~ .checkmark {
      background-color: var(--color-violet);
      border-color: var(--color-violet);
    }
    .option-item .checkmark::after {
      content: "";
      position: absolute;
      display: none;
      left: 7px;
      top: 3px;
      width: 5px;
      height: 10px;
      border: solid white;
      border-width: 0 3px 3px 0;
      transform: rotate(45deg) scale(0);
      transition: transform .2s ease-in-out;
    }
    .option-item input[type="checkbox"]:checked ~ .checkmark::after {
      display: block;
      transform: rotate(45deg) scale(1);
    }
    .option-item input[type="checkbox"]:focus-visible ~ .checkmark {
      box-shadow: 0 0 0 3px rgba(124,58,237,.2);
    }
  </style>
<link rel="stylesheet" href="/index.css">
</head>
<body data-size="default">
  <canvas id="bg-canvas"></canvas>

  <header class="app-header">
    <a href="index.html" aria-label="Accueil">
      <img src="logo-2.png" alt="Logo La Ruche" class="logo-img">
    </a>
  </header>

  <main class="main-content">
    <div class="tool-wrapper">
      <h1 class="tool-title">Générateur de Mots de Passe</h1>

      <div class="generator-card" role="region" aria-label="Générateur de Mots de Passe">
        <div class="output-wrapper">
          <input type="text" id="password-output" class="form-input" readonly aria-label="Mot de passe généré">
          <button id="copy-btn" class="btn btn-primary" aria-label="Copier le mot de passe">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
          </button>
        </div>

        <div class="form-group">
            <label for="length-slider" class="form-label">Longueur du mot de passe</label>
            <div class="length-control">
                <input type="range" id="length-slider" min="8" max="64" value="16" class="form-range">
                <span id="length-value" class="length-value">16</span>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">Options des caractères</label>
            <div class="options-grid">
                <label class="option-item" for="check-uppercase">
                  <input type="checkbox" id="check-uppercase" checked>
                  <span class="checkmark"></span>
                  Majuscules (A-Z)
                </label>
                <label class="option-item" for="check-lowercase">
                  <input type="checkbox" id="check-lowercase" checked>
                  <span class="checkmark"></span>
                  Minuscules (a-z)
                </label>
                <label class="option-item" for="check-numbers">
                  <input type="checkbox" id="check-numbers" checked>
                  <span class="checkmark"></span>
                  Chiffres (0-9)
                </label>
                <label class="option-item" for="check-symbols">
                  <input type="checkbox" id="check-symbols" checked>
                  <span class="checkmark"></span>
                  Symboles (!@#$)
                </label>
            </div>
        </div>
        
        <button id="generate-btn" class="btn btn-primary full-width-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg>
          Générer un nouveau mot de passe
        </button>

        <p id="status-text" class="status-text" aria-live="polite"></p>
      </div>
    </div>
  </main>

  <script>
    // Background hex grid — NE PAS MODIFIER (doit rester visuellement identique)
    (function(){
      const c = document.getElementById('bg-canvas');
      const ctx = c.getContext('2d');
      function draw(){
        const dpr = window.devicePixelRatio || 1;
        const rect = c.getBoundingClientRect();
        c.width = rect.width * dpr; c.height = rect.height * dpr;
        ctx.setTransform(dpr,0,0,dpr,0,0);
        ctx.clearRect(0,0,rect.width,rect.height);

        const size = 24;
        const hexW = 2 * size;
        const hexH = Math.sqrt(3) * size;
        const stepX = hexW * 3/4;
        ctx.strokeStyle = 'rgba(124,58,237,0.10)';
        ctx.lineWidth = 1;

        for(let row=0; row*hexH < rect.height + hexH; row++){
          for(let col=0; col*stepX < rect.width + hexW; col++){
            const x = col * stepX;
            const y = row * hexH + (col % 2 ? hexH/2 : 0);
            ctx.beginPath();
            for(let i=0;i<6;i++){
              const a = 2 * Math.PI / 6 * i;
              const px = x + size * Math.cos(a);
              const py = y + size * Math.sin(a);
              if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
            }
            ctx.closePath(); ctx.stroke();
          }
        }
      }
      window.addEventListener('resize', draw, {passive:true});
      draw();
    })();

    // Outil de génération de mot de passe
    (function() {
        const passwordOutputEl = document.getElementById('password-output');
        const copyBtn = document.getElementById('copy-btn');
        const statusTextEl = document.getElementById('status-text');
        const lengthSlider = document.getElementById('length-slider');
        const lengthValueEl = document.getElementById('length-value');
        const uppercaseCheck = document.getElementById('check-uppercase');
        const lowercaseCheck = document.getElementById('check-lowercase');
        const numbersCheck = document.getElementById('check-numbers');
        const symbolsCheck = document.getElementById('check-symbols');
        const generateBtn = document.getElementById('generate-btn');
        const allChecks = [uppercaseCheck, lowercaseCheck, numbersCheck, symbolsCheck];

        const CHARSETS = {
            uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            lowercase: 'abcdefghijklmnopqrstuvwxyz',
            numbers: '0123456789',
            symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
        };

        function generatePassword() {
            const length = parseInt(lengthSlider.value, 10);
            let availableChars = '';
            let guaranteedChars = [];
            
            if (uppercaseCheck.checked) {
                availableChars += CHARSETS.uppercase;
                guaranteedChars.push(CHARSETS.uppercase[Math.floor(Math.random() * CHARSETS.uppercase.length)]);
            }
            if (lowercaseCheck.checked) {
                availableChars += CHARSETS.lowercase;
                guaranteedChars.push(CHARSETS.lowercase[Math.floor(Math.random() * CHARSETS.lowercase.length)]);
            }
            if (numbersCheck.checked) {
                availableChars += CHARSETS.numbers;
                guaranteedChars.push(CHARSETS.numbers[Math.floor(Math.random() * CHARSETS.numbers.length)]);
            }
            if (symbolsCheck.checked) {
                availableChars += CHARSETS.symbols;
                guaranteedChars.push(CHARSETS.symbols[Math.floor(Math.random() * CHARSETS.symbols.length)]);
            }

            if (availableChars === '') {
                passwordOutputEl.value = 'Sélectionnez une option';
                return;
            }

            let password = [...guaranteedChars];
            const remainingLength = length - password.length;

            for (let i = 0; i < remainingLength; i++) {
                const randomIndex = Math.floor(Math.random() * availableChars.length);
                password.push(availableChars[randomIndex]);
            }
            
            // Shuffle the password (Fisher-Yates algorithm)
            for (let i = password.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [password[i], password[j]] = [password[j], password[i]];
            }

            passwordOutputEl.value = password.join('').slice(0, length);
            statusTextEl.textContent = '';
        }

        function updateLengthValue() {
            lengthValueEl.textContent = lengthSlider.value;
        }

        function copyToClipboard() {
            if (!passwordOutputEl.value || passwordOutputEl.value === 'Sélectionnez une option') return;
            navigator.clipboard.writeText(passwordOutputEl.value)
                .then(() => {
                    statusTextEl.textContent = 'Copié dans le presse-papiers !';
                    setTimeout(() => { statusTextEl.textContent = ''; }, 2500);
                })
                .catch(err => {
                    statusTextEl.textContent = 'Erreur de copie';
                    console.error('Erreur lors de la copie : ', err);
                });
        }

        function handleCheckChange() {
            const isAnyChecked = allChecks.some(check => check.checked);
            generateBtn.disabled = !isAnyChecked;
            if (isAnyChecked) {
                generatePassword();
            } else {
                passwordOutputEl.value = 'Sélectionnez une option';
            }
        }

        // Event Listeners
        lengthSlider.addEventListener('input', () => {
            updateLengthValue();
            generatePassword();
        });

        generateBtn.addEventListener('click', generatePassword);
        copyBtn.addEventListener('click', copyToClipboard);
        allChecks.forEach(check => check.addEventListener('change', handleCheckChange));

        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            updateLengthValue();
            handleCheckChange();
        });
    })();
  </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>