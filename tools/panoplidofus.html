
<!DOCTYPE html>
<html lang="fr" data-app="laruche">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guide Panoplies Dofus — La Ruche</title>
  <meta name="description" content="Un outil compact pour trouver la meilleure panoplie pour votre classe et votre niveau sur Dofus (1-100).">
  <style>
    :root {
      --color-bg: #FFFFFF;
      --color-bg-alt: #F7F8FA;
      --color-border: #E9EAF0;
      --color-text-primary: #141417;
      --color-text-secondary: #6B7280;
      --color-violet: #7C3AED;
      --color-violet-dark: #6D28D9;
      --radius-md: 12px;
      --radius-lg: 14px;
      --tool-max-w: 480px;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { height: 100%; background-color: var(--color-bg); }
    body {
      height: 100vh; overflow: hidden; display: flex; flex-direction: column;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--color-text-primary); line-height: 1.5; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    body[data-size="default"] { --tool-max-w: 480px; }
    body[data-size="wide"] { --tool-max-w: 960px; }
    body[data-size="xl"] { --tool-max-w: 1200px; }

    #bg-canvas { position: fixed; inset: 0; width: 100%; height: 100%; z-index: -1; }

    .app-header {
      flex-shrink: 0; background: var(--color-bg-alt); border-bottom: 1px solid var(--color-border);
      padding: 0 24px; display: flex; align-items: center; height: 70px;
    }
    .app-header a { display: inline-flex; align-items: center; }
    .logo-img { height: 70px; width: auto; vertical-align: middle; }

    .main-content {
      flex-grow: 1; display: flex; align-items: flex-start; justify-content: center;
      padding: 48px 24px; overflow-y: auto;
    }
    .tool-wrapper { display: flex; flex-direction: column; align-items: center; position: relative; width: 100%;}
    .tool-title {
      font-size: 1.75rem; font-weight: 600; padding: 12px 28px;
      background: linear-gradient(45deg, var(--color-violet), var(--color-violet-dark));
      color: #fff; border-radius: var(--radius-md); margin-bottom: -20px; position: relative; z-index: 5;
      box-shadow: 0 4px 14px -4px rgba(124, 58, 237, .4);
    }
    .generator-card {
      background: var(--color-bg); border: 1px solid var(--color-border); border-radius: var(--radius-lg);
      padding: 28px; padding-top: 40px; width: 100%; max-width: var(--tool-max-w);
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 5%), 0 2px 4px -2px rgb(0 0 0 / 5%);
      display: flex; flex-direction: column; gap: 24px;
    }
    .form-group { display: flex; flex-direction: column; gap: 8px; }
    .form-label { font-weight: 500; color: var(--color-text-primary); }
    .form-input {
      width: 100%; padding: 10px 14px; border: 1px solid var(--color-border); border-radius: var(--radius-md);
      font-size: 1rem; color: var(--color-text-primary); background: var(--color-bg);
      transition: border-color .2s, box-shadow .2s;
    }
    .form-input:focus { outline: none; border-color: var(--color-violet); box-shadow: 0 0 0 3px rgba(124, 58, 237, .2); }
    
    .class-selector {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 12px;
    }
    .class-btn {
      padding: 10px;
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      background-color: var(--color-bg);
      color: var(--color-text-primary);
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      font-size: 14px;
    }
    .class-btn:hover:not(.active) {
      border-color: var(--color-violet);
      color: var(--color-violet);
    }
    .class-btn.active {
      background: linear-gradient(45deg, var(--color-violet), var(--color-violet-dark));
      color: #fff;
      border-color: transparent;
      box-shadow: 0 4px 14px -4px rgba(124, 58, 237, .4);
    }
    .class-btn:focus-visible {
       outline: none;
       border-color: var(--color-violet);
       box-shadow: 0 0 0 3px rgba(124, 58, 237, .2);
    }

    .actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 12px; }
    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      font-weight: 500; padding: 10px 16px; border-radius: var(--radius-md); border: none; cursor: pointer;
      transition: background-color .2s, box-shadow .2s; font-size: 14px;
    }
    .btn:focus-visible { outline: 2px solid transparent; outline-offset: 2px; box-shadow: 0 0 0 3px rgba(124, 58, 237, .4); }
    .btn-primary { background: var(--color-violet); color: #fff; }
    .btn-primary:hover:not(:disabled) { background: var(--color-violet-dark); }
    .btn-primary:disabled { background: #A78BFA; cursor: not-allowed; }

    #result-wrapper {
      padding-top: 16px;
      border-top: 1px solid var(--color-border);
    }
    .set-header { text-align: center; margin-bottom: 24px; }
    .set-name { font-size: 1.5rem; font-weight: 600; color: var(--color-text-primary); }
    .set-description { font-size: 1rem; color: var(--color-text-secondary); }
    .items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 16px;
    }
    .item-card {
      background: var(--color-bg-alt);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      padding: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .item-image {
      width: 48px;
      height: 48px;
      margin-bottom: 8px;
    }
    .item-image svg { width: 100%; height: 100%; fill: url(#icon-gradient); }
    .item-name { font-weight: 500; font-size: 0.9rem; }
    .item-obtain { font-size: 0.8rem; color: var(--color-text-secondary); margin-top: 4px; }
    .status-text { text-align: center; color: var(--color-text-secondary); padding: 16px 0;}
  </style>
<link rel="stylesheet" href="/index.css">
</head>
<body data-size="default">
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <linearGradient id="icon-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:var(--color-violet-dark);" />
        <stop offset="100%" style="stop-color:var(--color-violet);" />
      </linearGradient>
    </defs>
  </svg>
  <canvas id="bg-canvas"></canvas>

  <header class="app-header">
    <a href="/" aria-label="Accueil">
      <img src="logo-2.png" alt="Logo La Ruche" class="logo-img">
    </a>
  </header>

  <main class="main-content">
    <div class="tool-wrapper">
      <h1 class="tool-title">Guide Panoplies Dofus</h1>
      <div class="generator-card" role="region" aria-label="Guide Panoplies Dofus">
        <form id="panoplie-form">
          <div class="form-group">
            <label class="form-label">Votre Classe</label>
            <div id="class-selector" class="class-selector"></div>
            <input type="hidden" id="selected-class-input" required>
          </div>
          <div class="form-group">
            <label for="level-input" class="form-label">Votre Niveau</label>
            <input type="number" id="level-input" class="form-input" min="1" max="100" placeholder="Ex: 45" required>
          </div>
          <div class="actions">
            <button type="submit" class="btn btn-primary">Trouver ma panoplie</button>
          </div>
        </form>

        <div id="result-wrapper">
          <p class="status-text">Choisissez une classe et un niveau pour voir une suggestion de panoplie.</p>
        </div>
      </div>
    </div>
  </main>

  <script type="module">
    // --- DATABASE ---
    const ICONS = {
      helmet: `<svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 1.63.52 3.14 1.41 4.41L6 18h2.2c.45 1.12 1.45 2 2.8 2s2.35-.88 2.8-2H16l-.41-4.59C16.48 12.14 17 10.63 17 9c0-3.87-3.13-7-5-7zm0 2c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z"/></svg>`,
      cloak: `<svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2.8 17.59C6.41 17.43 5 14.53 5 11V6.3l7-3.11 7 3.11V11c0 3.53-1.41 6.43-4.2 7.59-.69-.25-1.34-.6-1.93-1.04l-1.87 1.04z"/></svg>`,
      amulet: `<svg viewBox="0 0 24 24"><path d="M11 2.1c0-.6.5-1.1 1.1-1.1s1.1.5 1.1 1.1v.9c.9 0 1.8.1 2.6.4.5.1.8.6.7 1.1-.1.5-.6.8-1.1.7-2-.6-4.2-.6-6.2 0-.5.1-.9-.2-1.1-.7s.2-.9.7-1.1c.9-.2 1.8-.4 2.6-.4v-.9zM5.3 6.9c-.4-.4-.4-1 0-1.4.4-.4 1-.4 1.4 0l1.1 1.1c.4-.3.8-.5 1.3-.7-.6-.9-1-2-1-3.2 0-.6.5-1.1 1.1-1.1s1.1.5 1.1 1.1c0 1.2-.4 2.3-1 3.2.5.2.9.4 1.3.7l1.1-1.1c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4L15 8.1c.3.4.6.8.8 1.3l1.2-1c.5-.4 1.1-.2 1.4.3.4.5.2 1.1-.3 1.4l-1.2 1c.1.5.1 1 .1 1.4s0 .9-.1 1.4l1.2 1c.5.4.6 1 .3 1.4-.4.5-1 .6-1.4.3l-1.2-1c-.2.5-.5.9-.8 1.3l1.2 1.2c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0l-1.2-1.2c-.4.3-.9.6-1.3.8V21c0 .6-.5 1.1-1.1 1.1s-1.1-.5-1.1-1.1v-1.1c-.5-.2-.9-.5-1.3-.8L8.1 20.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4l1.2-1.2c-.3-.4-.6-.8-.8-1.3l-1.2 1c-.5.4-1.1.2-1.4-.3-.4-.5-.2-1.1.3-1.4l1.2-1c-.1-.5-.1-1-.1-1.4s0-.9.1-1.4l-1.2-1c-.5-.4-.6-1-.3-1.4.3-.5 1-.6 1.4-.3l1.2 1c.2-.5.5-.9.8-1.3L5.3 6.9zM12 16c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z"/></svg>`,
      ring: `<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm-4-8c0-2.21 1.79-4 4-4s4 1.79 4 4-1.79 4-4 4-4-1.79-4-4z"/></svg>`,
      belt: `<svg viewBox="0 0 24 24"><path d="M21 7v10h-2V7h2zm-4 0v10h-2V7h2zM4 7h11v10H4V7zm2 2v6h7V9H6zm2 2h3v2H8v-2z"/></svg>`,
      boots: `<svg viewBox="0 0 24 24"><path d="M20.5 15.5c-1.2 0-2.2-.9-2.4-2.1-.1-.6 0-1.2.3-1.7l1.3-2.5c.2-.3.1-.7-.2-1-.3-.2-.7-.1-1 .2l-1.3 2.5c-.3.5-.8 1-1.3 1.2-.5.2-1.1.3-1.6.2l-3-1.1c-.5-.2-1.1 0-1.4.4-.3.4-.4.9-.2 1.4l3 6.1c.3.5.8.8 1.4.8H18c1.1 0 2.1-.9 2.2-2 .1-.5-.1-1-.5-1.3-.4-.3-.9-.5-1.5-.5zM4 19h10v-2H4c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h4v2H4v10h10v-1.5c.6.3 1.2.5 1.9.5H16c0 .6.2 1.1.5 1.6l.2.4H4z"/></svg>`,
      weapon: `<svg viewBox="0 0 24 24"><path d="M14.72 4.28L12 7.01 9.28 4.28 4.28 9.28 7.01 12l-2.73 2.73L2.2 12.65l-1.41 1.41 2.08 2.08 7.07 7.07 1.41-1.41L9.28 20l2.08-2.08L14.09 15.2l2.73-2.73 2.73 2.73L21.78 14.09l-2.73-2.73L21.78 8.64l-2.08-2.08L14.72 4.28zm-2.08 1.36L14.09 7.1l-1.45 1.45-1.45-1.45L9.75 5.64l1.45-1.45L12.64 5.64zM7.1 9.75l1.45-1.45 1.45 1.45-1.45 1.45L7.1 9.75zm8.48 8.48l-1.45 1.45-1.45-1.45 1.45-1.45 1.45 1.45zm-1.45-2.9L12.7 16.78l-1.45 1.45-1.45-1.45-1.45 1.45-1.45-1.45 1.45-1.45 1.45 1.45 1.45-1.45 1.45 1.45zm2.9-2.9l-1.45 1.45-1.45-1.45 1.45-1.45 1.45 1.45z"/></svg>`,
      shield: `<svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 2.09L18 6.51V11c0 4.2-2.73 8.3-6 9.88C8.73 19.3 6 15.2 6 11V6.51L12 3.09z"/></svg>`,
    };
    
    const DB = {
      classes: [
        { id: "iop", name: "Iop", build: "terre" },
        { id: "cra", name: "Crâ", build: "air" },
        { id: "sacrieur", name: "Sacrieur", build: "agilite" },
        { id: "ecaflip", name: "Ecaflip", build: "terre" },
        { id: "eniripsa", name: "Eniripsa", build: "feu" },
        { id: "sadida", name: "Sadida", build: "terre" },
        { id: "feca", name: "Féca", build: "feu" },
        { id: "osamodas", name: "Osamodas", build: "feu" },
        { id: "enutrof", name: "Enutrof", build: "eau" },
        { id: "sram", name: "Sram", build: "air" },
        { id: "xelor", name: "Xélor", build: "feu" },
        { id: "pandawa", name: "Pandawa", build: "terre" }
      ],
      panoplies: {
        terre: [
          { levelRange: [1, 20], name: "Panoplie de l'Aventurier", description: "Parfaite pour débuter, elle donne de la sagesse et des bonus partout.", items: [
            { name: "Chapeau de l'Aventurier", type: 'helmet', obtain: "Drop sur monstres des Champs" },
            { name: "Cape de l'Aventurier", type: 'cloak', obtain: "Drop sur monstres des Champs" },
            { name: "Amulette de l'Aventurier", type: 'amulet', obtain: "Craft (Bijoutier)" },
            { name: "Anneau de l'Aventurier", type: 'ring', obtain: "Drop sur monstres des Champs" },
            { name: "Ceinture de l'Aventurier", type: 'belt', obtain: "Drop sur monstres des Champs" },
            { name: "Bottes de l'Aventurier", type: 'boots', obtain: "Drop sur monstres des Champs" }
          ]},
          { levelRange: [20, 50], name: "Panoplie du Bouftou", description: "Excellent choix force et vitalité pour commencer à frapper fort.", items: [
            { name: "Coiffe du Bouftou", type: 'helmet', obtain: "Drop sur Bouftous" },
            { name: "Cape du Bouftou", type: 'cloak', obtain: "Drop sur Bouftous" },
            { name: "Amulette du Bouftou", type: 'amulet', obtain: "Craft (Bijoutier)" },
            { name: "Anneau du Bouftou", type: 'ring', obtain: "Craft (Bijoutier)" },
            { name: "Ceinture du Bouftou", type: 'belt', obtain: "Craft (Tailleur)" },
            { name: "Bottes du Bouftou", type: 'boots', obtain: "Craft (Cordonnier)" },
            { name: "Marteau du Bouftou", type: 'weapon', obtain: "Craft (Forgeron)" }
          ]},
          { levelRange: [50, 80], name: "Panoplie du Bouftou Royal", description: "Une amélioration directe, plus de force, de vitalité et des résistances.", items: [
            { name: "Coiffe du Bouftou Royal", type: 'helmet', obtain: "Donjon des Bouftous" },
            { name: "Cape du Bouftou Royal", type: 'cloak', obtain: "Donjon des Bouftous" },
            { name: "Anneau du Bouftou Royal", type: 'ring', obtain: "Donjon des Bouftous" },
            { name: "Ceinture Royale du Bouftou", type: 'belt', obtain: "Craft (Tailleur)" },
            { name: "Bottes Royales du Bouftou", type: 'boots', obtain: "Craft (Cordonnier)" },
            { name: "Amulette du Bouftou Royal", type: 'amulet', obtain: "Donjon des Bouftous" }
          ]},
          { levelRange: [80, 100], name: "Panoplie Blop Reinette Royale", description: "Très puissante, elle offre force, vitalité et un bonus PA.", items: [
            { name: "Coiffe Blop Reinette Royale", type: 'helmet', obtain: "Donjon des Blops" },
            { name: "Cape Blop Reinette Royale", type: 'cloak', obtain: "Donjon des Blops" },
            { name: "Anneau Blop Reinette Royale", type: 'ring', obtain: "Donjon des Blops" },
            { name: "Ceinture Blop Reinette Royale", type: 'belt', obtain: "Donjon des Blops" }
          ]}
        ],
        air: [
          { levelRange: [1, 25], name: "Panoplie du Tofu", description: "Idéale pour l'agilité à bas niveau, elle donne beaucoup de mobilité.", items: [
            { name: "Coiffe du Tofu", type: 'helmet', obtain: "Drop sur Tofus" },
            { name: "Cape du Tofu", type: 'cloak', obtain: "Drop sur Tofus" },
            { name: "Anneau du Tofu", type: 'ring', obtain: "Craft (Bijoutier)" },
            { name: "Ceinture du Tofu", type: 'belt', obtain: "Craft (Tailleur)" }
          ]},
          { levelRange: [25, 60], name: "Panoplie du Scarafeuille Blanc", description: "Une base solide pour l'agilité avec de bonnes résistances.", items: [
            { name: "Coiffe du Scarafeuille Blanc", type: 'helmet', obtain: "Drop sur Scarafeuilles" },
            { name: "Cape du Scarafeuille Blanc", type: 'cloak', obtain: "Drop sur Scarafeuilles" },
            { name: "Anneau du Scarafeuille Blanc", type: 'ring', obtain: "Drop sur Scarafeuilles" },
            { name: "Ceinture du Scarafeuille Blanc", type: 'belt', obtain: "Drop sur Scarafeuilles" }
          ]},
          { levelRange: [60, 100], name: "Panoplie du Blop Coco Royal", description: "De l'agilité, de la vitalité, des bonus de portée et un PA.", items: [
            { name: "Coiffe Blop Coco Royale", type: 'helmet', obtain: "Donjon des Blops" },
            { name: "Cape Blop Coco Royale", type: 'cloak', obtain: "Donjon des Blops" },
            { name: "Anneau Blop Coco Royal", type: 'ring', obtain: "Donjon des Blops" },
            { name: "Ceinture Blop Coco Royale", type: 'belt', obtain: "Donjon des Blops" }
          ]}
        ],
        agilite: [
            { levelRange: [1, 20], name: "Panoplie du Piou Jaune", description: "Parfaite pour commencer avec un bonus agilité.", items: [
                { name: "Chapeau du Piou Jaune", type: 'helmet', obtain: "Drop sur Pious Jaunes" },
                { name: "Cape du Piou Jaune", type: 'cloak', obtain: "Drop sur Pious Jaunes" },
            ]},
            { levelRange: [20, 50], name: "Panoplie du Kwak du Vent", description: "Agilité et vitalité, un excellent set pour le milieu de jeu.", items: [
                { name: "Coiffe du Kwak de Vent", type: 'helmet', obtain: "Drop sur Kwaks de Vent" },
                { name: "Cape du Kwak de Vent", type: 'cloak', obtain: "Drop sur Kwaks de Vent" },
                { name: "Anneau du Kwak de Vent", type: 'ring', obtain: "Drop sur Kwaks de Vent" },
                { name: "Kwaklame de Vent", type: 'weapon', obtain: "Craft (Forgeron)" },
            ]},
            { levelRange: [50, 100], name: "Panoplie Aerdala", description: "Un set agilité emblématique offrant un PA et d'excellents bonus.", items: [
                { name: "Coiffe Aerdala", type: 'helmet', obtain: "Drop/Craft (Pandala)" },
                { name: "Cape Aerdala", type: 'cloak', obtain: "Drop/Craft (Pandala)" },
                { name: "Ceinture Aerdala", type: 'belt', obtain: "Drop/Craft (Pandala)" },
                { name: "Bottes Aerdala", type: 'boots', obtain: "Drop/Craft (Pandala)" },
                { name: "Bouclier Aerdala", type: 'shield', obtain: "Craft (Forgeron)" },
            ]}
        ],
        feu: [
          { levelRange: [1, 20], name: "Panoplie du Boune", description: "Bonus d'intelligence et de vitalité pour bien débuter.", items: [
            { name: "Coiffe du Boune", type: 'helmet', obtain: "Quête du Boune" },
            { name: "Cape du Boune", type: 'cloak', obtain: "Quête du Boune" },
            { name: "Bâton du Boune", type: 'weapon', obtain: "Quête du Boune" }
          ]},
          { levelRange: [20, 60], name: "Panoplie du Scarafeuille Rouge", description: "Une base solide pour l'intelligence avec de bonnes résistances.", items: [
            { name: "Coiffe du Scarafeuille Rouge", type: 'helmet', obtain: "Drop sur Scarafeuilles" },
            { name: "Cape du Scarafeuille Rouge", type: 'cloak', obtain: "Drop sur Scarafeuilles" },
            { name: "Anneau du Scarafeuille Rouge", type: 'ring', obtain: "Drop sur Scarafeuilles" },
            { name: "Ceinture du Scarafeuille Rouge", type: 'belt', obtain: "Drop sur Scarafeuilles" }
          ]},
          { levelRange: [60, 100], name: "Panoplie du Blop Griotte Royal", description: "Intelligence, vitalité, bonus de portée et un PA.", items: [
            { name: "Coiffe Blop Griotte Royale", type: 'helmet', obtain: "Donjon des Blops" },
            { name: "Cape Blop Griotte Royale", type: 'cloak', obtain: "Donjon des Blops" },
            { name: "Anneau Blop Griotte Royal", type: 'ring', obtain: "Donjon des Blops" },
            { name: "Ceinture Blop Griotte Royale", type: 'belt', obtain: "Donjon des Blops" }
          ]}
        ],
        eau: [
          { levelRange: [1, 30], name: "Panoplie du Moskito", description: "Donne de la chance et de la prospection, parfait pour commencer.", items: [
            { name: "Chapeau du Moskito", type: 'helmet', obtain: "Drop sur Moskitos" },
            { name: "Cape du Moskito", type: 'cloak', obtain: "Drop sur Moskitos" },
            { name: "Anneau du Moskito", type: 'ring', obtain: "Drop sur Moskitos" }
          ]},
          { levelRange: [30, 60], name: "Panoplie du Scarafeuille Bleu", description: "Une base solide pour la chance avec de bonnes résistances.", items: [
            { name: "Coiffe du Scarafeuille Bleu", type: 'helmet', obtain: "Drop sur Scarafeuilles" },
            { name: "Cape du Scarafeuille Bleu", type: 'cloak', obtain: "Drop sur Scarafeuilles" },
            { name: "Anneau du Scarafeuille Bleu", type: 'ring', obtain: "Drop sur Scarafeuilles" },
            { name: "Ceinture du Scarafeuille Bleu", type: 'belt', obtain: "Drop sur Scarafeuilles" }
          ]},
          { levelRange: [60, 100], name: "Panoplie du Blop Indigo Royal", description: "Chance, vitalité, bonus de portée et un PA.", items: [
            { name: "Coiffe Blop Indigo Royale", type: 'helmet', obtain: "Donjon des Blops" },
            { name: "Cape Blop Indigo Royale", type: 'cloak', obtain: "Donjon des Blops" },
            { name: "Anneau Blop Indigo Royal", type: 'ring', obtain: "Donjon des Blops" },
            { name: "Ceinture Blop Indigo Royale", type: 'belt', obtain: "Donjon des Blops" }
          ]}
        ]
      }
    };

    const form = document.getElementById('panoplie-form');
    const resultWrapper = document.getElementById('result-wrapper');
    const classSelector = document.getElementById('class-selector');
    const selectedClassInput = document.getElementById('selected-class-input');
    const levelInput = document.getElementById('level-input');

    function initializeClassSelector() {
      DB.classes.forEach(cls => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'class-btn';
        btn.textContent = cls.name;
        btn.dataset.classId = cls.id;
        classSelector.appendChild(btn);
      });
    }

    classSelector.addEventListener('click', (e) => {
      const target = e.target.closest('.class-btn');
      if (!target) return;

      document.querySelectorAll('.class-btn').forEach(btn => btn.classList.remove('active'));
      target.classList.add('active');
      selectedClassInput.value = target.dataset.classId;
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const selectedClassId = selectedClassInput.value;
      const level = parseInt(levelInput.value, 10);

      if (!selectedClassId || !level) {
        renderStatus("Veuillez sélectionner une classe et un niveau.");
        return;
      }
      
      const characterClass = DB.classes.find(c => c.id === selectedClassId);
      if (!characterClass) {
        renderStatus("Classe non trouvée.");
        return;
      }

      const buildType = characterClass.build;
      const panopliesForBuild = DB.panoplies[buildType];
      
      const foundPanoplie = panopliesForBuild.find(p => level >= p.levelRange[0] && level <= p.levelRange[1]);

      if (foundPanoplie) {
        renderPanoplie(foundPanoplie);
      } else {
        renderStatus(`Aucune panoplie spécifique trouvée pour le niveau ${level}. Essayez d'ajuster le niveau.`);
      }
    });

    function renderStatus(message) {
      resultWrapper.innerHTML = `<p class="status-text">${message}</p>`;
    }

    function renderPanoplie(panoplie) {
      const itemsHtml = panoplie.items.map(item => `
        <div class="item-card">
          <div class="item-image" aria-hidden="true">${ICONS[item.type] || ''}</div>
          <div class="item-name">${item.name}</div>
          <div class="item-obtain">${item.obtain}</div>
        </div>
      `).join('');

      resultWrapper.innerHTML = `
        <div class="set-header">
          <h2 class="set-name">${panoplie.name}</h2>
          <p class="set-description">${panoplie.description}</p>
        </div>
        <div class="items-grid">
          ${itemsHtml}
        </div>
      `;
    }

    initializeClassSelector();

  </script>
  
  <script>
    // Background hex grid — NE PAS MODIFIER (doit rester visuellement identique)
    (function(){
      const c = document.getElementById('bg-canvas');
      if (!c) return;
      const ctx = c.getContext('2d');
      function draw(){
        const dpr = window.devicePixelRatio || 1;
        const rect = c.getBoundingClientRect();
        c.width = rect.width * dpr; c.height = rect.height * dpr;
        ctx.setTransform(dpr,0,0,dpr,0,0);
        ctx.clearRect(0,0,rect.width,rect.height);

        const size = 24;
        const hexW = 2 * size;
        const hexH = Math.sqrt(3) * size;
        const stepX = hexW * 3/4;
        ctx.strokeStyle = 'rgba(124,58,237,0.10)';
        ctx.lineWidth = 1;

        for(let row=0; row*hexH < rect.height + hexH; row++){
          for(let col=0; col*stepX < rect.width + hexW; col++){
            const x = col * stepX;
            const y = row * hexH + (col % 2 ? hexH/2 : 0);
            ctx.beginPath();
            for(let i=0;i<6;i++){
              const a = 2 * Math.PI / 6 * i;
              const px = x + size * Math.cos(a);
              const py = y + size * Math.sin(a);
              if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
            }
            ctx.closePath(); ctx.stroke();
          }
        }
      }
      window.addEventListener('resize', draw, {passive:true});
      draw();
    })();
  </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
